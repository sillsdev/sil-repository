#!/bin/sh -e

# postinst script
#
# see: dh_installdeb(1)
#
# summary of how this script can be called:
#        * <postinst> `configure' <most-recently-configured-version>
#        * <old-postinst> `abort-upgrade' <new version>
#        * <conflictor's-postinst> `abort-remove' `in-favour' <package>
#          <new-version>
#        * <postinst> `abort-remove'
#        * <deconfigured's-postinst> `abort-deconfigure' `in-favour'
#          <failed-install-package> <version> `removing'
#          <conflicting-package> <version>
# for details, see http://www.debian.org/doc/debian-policy/ or
# the debian-policy package


. /usr/share/debconf/confmodule

case "$1" in
	configure)
		apt-key add - <<ENDOFKEY
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1.2.6 (GNU/Linux)

mQGiBEkGZmYRBACDz+hxLEWawGDUaX/zJWscm8PnCSLVwEiJR7MQxCjfrY045qTl
SJ3TXeqhP4tAxxRDao+jTkv5S8bDAQyOEOsSH9XuRLcQnrZOaqnQPrXVIZZJgPJV
bhgO+nsqxta/SqCnqwNxU0almZeZhiT3kFhOhZA3uBgnPafT1YDpSXaJmwCgl7fn
suRkSRS7oiNJyBQZ+Ie/MFUD/0NQdVojnqzdpj6uVWV6bEzlZ/C1J+QQ+CBtK5aD
u9txVtyp4PZvMWHnIKsCzBSCSzhiZXfq2hZrDHLHdK+3bA0lPc8YYAZ0EjHjnrcQ
trQbFKJcG8iRjVzeyH93xjpMrGaG85J3SZtNJv0Abmm83xTazQocLirP3D3JYuP6
IMxeA/0U5OAZSaEgIHWy9eIs4MmKHg7ZQ4vKNXJMS4rGh6NF2c3oiMo1C1+Ayt2w
B/fg8GhRXHrwFmU31pT6Dlgk5jkJ5pAtipFjurfIYwCNRMDMT9C8z/Qcm8bskGWg
aggSBp6gQfBeTye0xITl0er8ZZVCPi0FA3psKZx+UFz9f6J7yrQnU0lMIFBhY2th
Z2VzIDxhcmNoaXZlQHBhY2thZ2VzLnNpbC5vcmc+iF4EExECAB4FAkkGZmYCGwMG
CwkIBwMCAxUCAwMWAgECHgECF4AACgkQgPJRrCxWAx/WGwCgjLVDwECypUi+g/8e
8zOHsG/WtikAni68rwTi6DeXN+7QhA2a3YGxkt/HuQENBEkGZmgQBACtsqXLO4RW
D3cfEacs6RVtNqD8Qs+bT4E+TZfEqmMSQjvGQoJYIFWhWFXHeLoNdiTFzbCXASXZ
ITNGkG6ZwjH+9XrjYPJYBDglhgDXXx2RXdUaMJXlkbQUADxxINQQd7ew7LFcTs0i
MVWCBhuCYVSdrbnjakzB6IMmD2eVlMVcuwADBQP9GHtRaW0SNN10bQ98cPWKUa5u
rmiZeJNOXQw7mU9g8TAUoHD6YEazI5jOcanLYSB0olkimDKoQzK3RnNwmtEFSQgc
vFeUdrsgzPvSwkYbH7O6GcBx2ApEh9n5ZzKPUa3bvEicwUINodo0kcL0+O8Ilzcu
Sv/VQViz9c63fDH7Ij2ISQQYEQIACQUCSQZmaAIbDAAKCRCA8lGsLFYDHwKdAJ9d
bIzHz8Z/y0jikDFu7X6tMik+EgCfSl/2iQLZXZzKZBI793rvogW+cM8=
=yYbw
-----END PGP PUBLIC KEY BLOCK-----
ENDOFKEY

		OS=ubuntu
		DISTRIBUTOR_ID=$(lsb_release -is)
		if [ "$DISTRIBUTOR_ID" = "Debian" ]; then
			OS=debian
		fi
		OS_CODENAME=$(lsb_release -sc)
		if [ -f /etc/wasta-release ]; then
			OS_CODENAME=$(cat /etc/wasta-release | grep ^CODENAME | perl -p -e 's/CODENAME=//')
		fi
		LIST_FILE=/etc/apt/sources.list.d/packages-sil-org.list

		echo "# This file was automatically generated" > $LIST_FILE
		echo "deb http://packages.sil.org/$OS $OS_CODENAME main" >> $LIST_FILE
	;;

	abort-upgrade|abort-remove|abort-deconfigure)
	;;

	*)
		echo "postinst called with unknown argument: $1" >&2
		exit 1
	;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
